# Урок 7
Работа с БД, С++ модели, кастомизация с помощью шаблонов

1. В первом задании в обе модели добавил роли для всплывающей подсказки и для доступа к полю в базе данных (название столбца), то есть для удобного вызова скульного апдейта записи. Реализовал провайдер ширины столбца, который в зависимости от модели и номера столбца возвращает его ширину, в дальнейшем используемую для подсчёта общей ширины таблицы с помощью reduce. Для редактирования по двойному клику на ячейке благодаря лоадеру подгружаю текстфилд с последующим апдейтом в БД и ролей в модели. Тейблвью имеет только делегата ячейки, и поэтому пришлось добавить немного логики для отображения красивых линий между ячейками, а также рамку таблицы (банальный бордер для каждой ячейки не подходит, так как при наложении друг на друга линии между ячейками становятся жирнее, чем рамка)  
2. Во втором задании полностью переделал пример из методички (вебинара). Изменил модель, убрав из неё все лишнии роли. Оставил только роль display и tooltip (так как QML позволяет работать с ролями в модели для TableView). Также заменил структуру данных на QVariantList. При таком подходе TableView заработал чуть ли не из коробки. Из сложного, это отображение последнего столбца, в котором данные хранятся в виде QStringList. Здесь по заданию требуется использовать SwipeView. В моей реализации делегат ячейки всегда содержит SwipeView с репитером внутри с той лишь только разницей, что для обычных столбцов он имеет один компонент текста, а для столбца с друзьями количество компонентов равно длине списка друзей. Для хорошего UX добавил PageIndicator, говорящий пользователю на каком элементе списка друзей он находится. Тултип реализон аналогично предыдущему заданию, и отображается только в случае, если текст в ячейки был обрезан  
3. В третьем задании обошёлся без шаблонов, так как в задании не сказано, что нужно обязательно их использовать. Скругление углов попапа не представляет никакой сложности. Цвета для раскраски попапа и радиус скругления вынес в публичные проперти кастомного попапа. А вот с анимацией в комбобоксе пришлось повозиться, прежде чем пришло красивое решение - в индикатор добавил проперти угол поворота, которое при отрисовке используется для поворачивания рисуемой стрелочки, а снаружи, а точнее в попапе при выпадении и скрытии запускается анимация этого проперти у индикатора. Также добавил анимацию плавного появления и исчезновения самого попапа комбобокса. В мейне сделал логику отображения попапа (кастомный независимый) только после выбора элеента внутри комбобокса. Чтобы отображать независимый попап только после завершения анимации в комбобоксе пришлось добавить сигнал closed, который привязал к сигналу closed внутреннего попапа комбобокса. На случай, если кастомизация компонентов без шаблона не доступна, прикладываю [демонстрацию](https://github.com/bazyak/qml/blob/qml07/qml07/ex_7_3_demo.mov) работы приложения
